p=lambda d,E=enumerate:[[max({*sum(d[:i+1],[])}&{*sum(d[i:],[])}&{*sum((D:=[*zip(*d)])[:j+1],())}&{*sum(D[j:],())})for j,_ in E(r)]for i,r in E(d)]