def p(g,E=enumerate):b=max(sum(g,[]),key=sum(g,[]).count);a=[v for v in sum(g,[])if f"{b}, {v}, {b}"not in str(g+[*zip(*g)])][0];o=[[[b,a][v==a]for v in r[::2]]for r in g[::2]];m=[r*2 for r in g*2];return[[[[b,k][v==k]for v,f in zip(i,zip(*g))if k in f]for i in g if k in i]for i,r in E(m)for j,v in E(r)for k in{*sum(g,[])}if[[[b,a][v==k]for v in r[j:j+len(o[0])]]for r in m[i:i+len(o)]]==o][0]