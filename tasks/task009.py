p=lambda d,E=enumerate:[(d:=[[c or[c,m][m in r[:j]and m in r[j:]or m in C[:i]and m in C[i:]]for j,(c,C)in E(zip(r,zip(*d)))]for i,r in E(d)])for m in{*sum(d,[])}-{0,d[0][2]}][-1]