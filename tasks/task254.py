def p(d):a,*_,b=sorted(filter(any,D:=[*zip(*d)]),key=sum);return[[c and[C==b,2][C==a]for c,C in zip(r,D)]for r in d]