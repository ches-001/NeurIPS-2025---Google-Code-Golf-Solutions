p=lambda d:[d:=[[[c,r[u:=r.index(min(r,key=r.count))]][len({*r})>2>sum(r[j:])+r[u-(u>0)]<1]for j,c in enumerate(r)]for r in zip(*d[::-1])]for _ in d][3]