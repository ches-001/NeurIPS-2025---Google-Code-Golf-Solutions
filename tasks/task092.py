p=lambda d:[d:=[[c or[c,m:=max([s:={0},{*r}-s][sum(r)>0],key=r.count)][m in r[:j]and m in r[j:]]for j,c in enumerate(r)]for r in zip(*d)]for _ in[0]*2][1]